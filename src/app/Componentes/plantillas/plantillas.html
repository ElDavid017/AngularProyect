<div class="container">

  <div class="grid-firmas">
    <!-- Columna izquierda: Título + Seleccionador (apilados) -->
    <div class="col-izq">
      <div class="card-box">
        <h1>REPORTES DE PLANTILLAS</h1>
      </div>
      <div class="card-box">
        <div class="bloque-seleccionador">
          <label for="tipoBusqueda">SELECCIONADOR</label>
          <select id="tipoBusqueda" disabled>
            <option selected>Plantillas por caducar</option>
          </select>
          <!-- Botón movido dentro del contenedor del seleccionador -->
          <div class="selector-accion">
            <button class="btn-cargar" (click)="cargarDatos()">CARGAR DATOS</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Columna derecha: Filtros con título -->
    <div class="col-der">
      <div class="bloque-filtros">
        <div class="box-title">CARGAR CAMPOS DINAMICAMENTE PARA FILTRO</div>
        <div class="filtros-linea">
          <div class="campo">
            <label for="fecha_inicio">FECHA INICIAL</label>
            <input type="date" id="fecha_inicio" [(ngModel)]="fechaInicio" required />
          </div>

          <div class="campo">
            <label for="fecha_fin">FECHA FINAL</label>
            <input type="date" id="fecha_fin" [(ngModel)]="fechaFin" required />
          </div>
        </div>
        <div class="acciones-der" style="visibility:hidden; height:0; margin:0; padding:0;">
          <!-- botón movido arriba para mantener estructura visual; oculto aquí -->
        </div>
      </div>
    </div>
  </div>

  <div class="resultado-boton" *ngIf="datosCargados">
    <div *ngIf="totalResults > 0">SE ENCONTRARON N° <strong>{{totalResults}}</strong> REGISTROS.</div>
    <div *ngIf="totalResults === 0">NO SE ENCONTRARON REGISTROS PARA LAS FECHAS SELECCIONADAS.</div>
    <button *ngIf="totalResults > 0" class="btn-excel" (click)="exportarExcel()">DESCARGAR EXCEL</button>
  </div>

  <div id="loading" class="loading" [style.display]="loading ? 'block' : 'none'">Cargando...</div>

  <div id="resultados" class="result">
    <div class="registro" *ngFor="let item of datos">
      <p><strong>ID:</strong> {{item.ID || item.id || '-'}}</p>
      <p><strong>MAC:</strong> {{item.MAC || '-'}}</p>
      <p><strong>RUC:</strong> {{item.RUC || '-'}}</p>
      <p><strong>NOMBRE:</strong> {{item.NOMBRE || '-'}}</p>
      <p><strong>TIPO PLANTILLA:</strong> {{item.TIPO_PLANTILLA || '-'}}</p>
      <p><strong>VENDEDOR:</strong> {{item.VENDEDOR || '-'}}</p>
      <p><strong>FECHA ACTIVACION:</strong> {{item.FECHA_ACTIVACION || '-'}}</p>
      <p><strong>FECHA CADUCIDAD:</strong> {{item.FECHA_CADUCIDAD || '-'}}</p>
      <p><strong>COMENTARIO:</strong> {{item.COMENTARIO || '-'}}</p>
      <p><strong>TELEFONO:</strong> {{item.TELEFONO || '-'}}</p>
      <p><strong>CORREO:</strong> {{item.CORREO || '-'}}</p>
      <p><strong>ESTADO:</strong> {{item.ESTADO || '-'}}</p>
      <p><strong>PRECIO:</strong> {{item.PRECIO || '-'}}</p>
      <p><strong>BANCO:</strong> {{item.BANCO || '-'}}</p>
      <p><strong>NUM FACTURA:</strong> {{item.NUM_FACTURA || '-'}}</p>
    </div>
  </div>

  <div id="paginacion" class="paginacion" *ngIf="mostrarPaginacion">
    <div class="pagina-info">Página {{pagina}} de {{totalPaginas}} — Mostrando {{startIndex}} - {{endIndex}} de {{totalResults}}</div>
    <div class="pagina-controles">
      <button class="btn" [disabled]="pagina<=1" (click)="cambiarPagina(-1)">Anterior</button>
      <button class="btn" [disabled]="pagina>=totalPaginas" (click)="cambiarPagina(1)">Siguiente</button>
    </div>
  </div>

  <div class="modal-overlay" *ngIf="showConfirmModal">
    <div class="modal-card">
      <div class="modal-icon">⚠️</div>
      <h3 class="modal-title" *ngIf="modalLoading">Espere, sus datos se están cargando...</h3>
      <div class="modal-spinner" *ngIf="modalLoading">⏳</div>

      <div class="modal-message" *ngIf="!modalLoading">
        <p>{{ modalMessage }}</p>
      </div>

      <div class="modal-actions">
        <button class="btn" (click)="cancelLoad()">Cancelar</button>
        <button class="btn modal-ok" *ngIf="!modalLoading" (click)="confirmLoad()">OK</button>
      </div>
    </div>
  </div>

</div>
